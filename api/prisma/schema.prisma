generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Users {
  id            Int            @id @default(autoincrement())
  active        Boolean        @default(true)
  createdAt     DateTime       @default(now()) @db.Timestamptz(3)
  email         String         @unique
  name          String
  password      String
  type          Int
  institutionId Int?
  institution   Institutions?   @relation(fields: [institutionId], references: [id], onDelete: Cascade)
  UserSubjects  UserSubjects[]
  UserTask      UserTasks[]
  points        Int?
}

model Institutions {
  id        Int      @id @default(autoincrement())
  active    Boolean  @default(true)
  createdAt DateTime @default(now()) @db.Timestamptz(3)
  name      String
  User      Users[]
}

model Subjects {
  id           Int            @id @default(autoincrement())
  active       Boolean        @default(true)
  createdAt    DateTime       @default(now()) @db.Timestamptz(3)
  name         String
  UserSubjects UserSubjects[]
}

model UserSubjects {
  id        Int      @id @default(autoincrement())
  active    Boolean  @default(true)
  createdAt DateTime @default(now()) @db.Timestamptz(3)
  userId    Int
  user      Users     @relation(fields: [userId], references: [id])
  subjectId Int
  subject   Subjects @relation(fields: [subjectId], references: [id])
}

model Tasks {
  id          Int        @id @default(autoincrement())
  active      Boolean    @default(true)
  createdAt   DateTime   @default(now()) @db.Timestamptz(3)
  periodStart DateTime
  periodEnd   DateTime
  level       Int
  UserTask    UserTasks[]
  Question    Questions[]
}

model UserTasks {
  id               Int                @id @default(autoincrement())
  active           Boolean            @default(true)
  createdAt        DateTime           @default(now()) @db.Timestamptz(3)
  taskId           Int
  task             Tasks               @relation(fields: [taskId], references: [id])
  userId           Int
  user             Users               @relation(fields: [userId], references: [id])
  status           Int
  level            Int
  score            Int
  UserTaskQuestion UserTaskQuestion[]
}

model Questions {
  id                  Int                   @id @default(autoincrement())
  active              Boolean               @default(true)
  createdAt           DateTime              @default(now()) @db.Timestamptz(3)
  title               String
  taskId              Int
  task                Tasks                  @relation(fields: [taskId], references: [id])
  QuestionAlternative QuestionAlternatives[]
  UserTaskQuestion    UserTaskQuestion[]
}

model QuestionAlternatives {
  id               Int                @id @default(autoincrement())
  active           Boolean            @default(true)
  createdAt        DateTime           @default(now()) @db.Timestamptz(3)
  isCorrect        Boolean
  questionId       Int
  question         Questions           @relation(fields: [questionId], references: [id])
  UserTaskQuestion UserTaskQuestion[]
}

model UserTaskQuestion {
  id            Int                 @id @default(autoincrement())
  active        Boolean             @default(true)
  createdAt     DateTime            @default(now()) @db.Timestamptz(3)
  questionId    Int
  question      Questions            @relation(fields: [questionId], references: [id])
  alternativeId Int
  alternative   QuestionAlternatives @relation(fields: [alternativeId], references: [id])
  userTaskId    Int
  userTask      UserTasks            @relation(fields: [userTaskId], references: [id])
}
